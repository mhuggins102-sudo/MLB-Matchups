<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    
    <title>MLB Matchups</title>

    <link rel="icon" href="icon-192.png">

    <!-- KEEP TWITTER TAGS (Ensures small card on Twitter) 
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="MLB Matchups">
    <meta name="twitter:description" content="The greatest baseball stats game on the web.">
    <meta name="twitter:image" content="https://mlb-matchups.mhuggins102.workers.dev/icon-180.png"> -->

    <!-- OPEN GRAPH TAGS -->
    <meta property="og:title" content="MLB Matchups">
    <meta property="og:description" content="The greatest baseball stats game on the web.">
    
    <!-- REMOVE THESE LINES to force iOS to fallback to apple-touch-icon -->
    <!-- <meta property="og:image" content="https://mlb-matchups.mhuggins102.workers.dev/icon-180.png"> -->
    <!-- <meta property="og:image:width" content="180"> -->
    <!-- <meta property="og:image:height" content="180"> -->
    
    <meta property="og:url" content="https://mlb-matchups.mhuggins102.workers.dev">
    <meta property="og:type" content="website">
    <link rel="manifest" href="manifest.json">
    <!-- iOS uses this for the small thumbnail if og:image is missing -->
    <link rel="apple-touch-icon" href="icon-192.png">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Matchups">


    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
    .hidden { display: none !important; }
        /* ... (Keep your existing styles exactly as they are below here) ... */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;800&display=swap');

  /* Failsafe: ensure hide/show works even if Tailwind CDN fails */
  .hidden { display: none !important; }

        :root {
            --color-primary: #2563eb; /* Blue-600 */
            --color-accent: #f59e0b;
            --color-success: #10b981;
            --color-danger: #ef4444;
            --color-warning: #f97316;
            
            /* Medal Colors */
            --color-bronze: #cd7f32;
            --color-silver: #708090;
            --color-gold: #ffd700;
            --color-platinum: #80e0e0;
        }

        body { font-family: 'Inter', sans-serif; -webkit-tap-highlight-color: transparent; }

        /* Animations */
        @keyframes fade-in { from { opacity: 0; transform: translate(-50%, -10px); } to { opacity: 1; transform: translate(-50%, 0); } }
        .animate-toast { animation: fade-in 0.3s ease-out forwards; }
        
        @keyframes fade-in-up { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .animate-enter { animation: fade-in-up 0.3s ease-out forwards; }
        
        @keyframes pulse-bull { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        .animate-bullseye { animation: pulse-bull 0.6s infinite ease-in-out; }
        
        @keyframes score-pop { 0% { transform: scale(1); } 50% { transform: scale(1.5); } 100% { transform: scale(1); } }
        .animate-score-pop { animation: score-pop 0.4s ease-out; }

        /* Score Color Classes */
        .score-bronze { color: var(--color-bronze); }
        .score-silver { color: var(--color-silver); }
        .score-gold { color: var(--color-gold); }
        .score-platinum { color: var(--color-platinum); }

        /* Scrollbar hiding */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Number Line */
        #number-line-track {
            height: 16px;
            border-radius: 999px;
            position: relative;
            overflow: hidden;
            background-color: #e5e7eb;
            transition: background-color 0.3s;
        }
        html.dark #number-line-track { background-color: #374151; }

        #invalid-zone {
            position: absolute; left: 0; top: 0; height: 100%; width: 0%;
            background: repeating-linear-gradient(45deg, #9ca3af, #9ca3af 2px, #d1d5db 2px, #d1d5db 8px);
            opacity: 0.5;
            z-index: 10;
            border-right: 1px solid #6b7280;
            transition: width 0.3s;
        }
        html.dark #invalid-zone {
             background: repeating-linear-gradient(45deg, #4b5563, #4b5563 2px, #1f2937 2px, #1f2937 8px);
        }

        #number-line-range { position: absolute; top: 0; height: 100%; background: var(--color-primary); opacity: 0.6; z-index: 20; border-radius: 999px; transition: all 0.2s; display: none; }
        #bullseye-band { position: absolute; top: 0; height: 100%; background: var(--color-accent); opacity: 0.9; z-index: 30; border-radius: 999px; transition: all 0.2s; display: none; }

        #answer-pin {
            position: absolute; top: -8px; width: 4px; height: 32px;
            background-color: var(--color-success); border-radius: 2px;
            transform: translateX(-50%); z-index: 40; display: none;
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.6);
        }
        .answer-incorrect #answer-pin { background-color: var(--color-danger); box-shadow: 0 0 8px rgba(239, 68, 68, 0.6); }
        .answer-partial #answer-pin { background-color: var(--color-warning); box-shadow: 0 0 8px rgba(249, 115, 22, 0.6); }

        /* Tick labels */
        .tick-label { position: absolute; top: 22px; transform: translateX(-50%); font-size: 0.7rem; font-weight: 600; opacity: 1; color: #4b5563; }
        html.dark .tick-label { color: #9ca3af; }
        
        .big-input { font-variant-numeric: tabular-nums; }
        
        /* --- UNIFIED BUTTON CLASS --- */
        .primary-btn {
            width: 100%;
            padding: 1rem 0; /* py-4 */
            background-color: var(--color-primary); /* blue-600 */
            color: white;
            font-weight: 700; /* bold */
            font-size: 1.125rem; /* text-lg */
            border-radius: 1rem; /* rounded-2xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); /* shadow-lg */
            transition-property: transform, opacity, background-color;
            transition-duration: 150ms;
            border: none;
            cursor: pointer;
        }
        .primary-btn:hover:not(:disabled) { background-color: var(--color-primary); }
        .primary-btn:active:not(:disabled) { transform: scale(0.98); }
        .primary-btn:disabled {
            background-color: #e5e7eb; /* gray-200 */
            color: #6b7280; /* gray-500 */
            box-shadow: none;
            cursor: not-allowed;
            opacity: 1; 
        }
        html.dark .primary-btn:disabled {
            background-color: #1f2937; /* gray-800 */
            color: #9ca3af; /* gray-400 */
        }
        
        details > summary { list-style: none; cursor: pointer; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] > summary svg { transform: rotate(180deg); }

        /* Leaderboard Styles */
        .leaderboard-row:nth-child(even) { background-color: rgba(0,0,0,0.02); }
        html.dark .leaderboard-row:nth-child(even) { background-color: rgba(255,255,255,0.02); }
        .leaderboard-new { background-color: rgba(16, 185, 129, 0.1) !important; font-weight: 800 !important; color: #059669 !important; }
        html.dark .leaderboard-new { background-color: rgba(16, 185, 129, 0.2) !important; color: #34d399 !important; }
        
        /* Showdown Grid */
        .sbs-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.25rem; align-items: center; }
        .sbs-row-label { font-size: 0.65rem; font-weight: 800; text-transform: uppercase; color: #6b7280; text-align: left; line-height: 1.1; }
        html.dark .sbs-row-label { color: #9ca3af; }
        
        .sbs-cell {
            height: 2rem; /* Smaller height */
            border-radius: 0.5rem;
            background-color: #f3f4f6;
            border: 2px solid transparent;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: 500; /* Less bold */
            font-size: 0.75rem; /* Smaller text */
            color: #6b7280; /* Gray text */
            transition: all 0.15s;
        }
        html.dark .sbs-cell { background-color: #1f2937; color: #9ca3af; }
        
        .sbs-cell.selected { 
            border-color: var(--color-primary); 
            background-color: #eff6ff; 
            color: var(--color-primary);
            font-weight: 700; /* Bold when selected */
        }
        html.dark .sbs-cell.selected { background-color: rgba(37, 99, 235, 0.2); color: #60a5fa; }
        
        .sbs-cell.correct { background-color: #dcfce7 !important; border-color: #16a34a !important; color: #166534 !important; font-weight: 800; }
        html.dark .sbs-cell.correct { background-color: rgba(22, 163, 74, 0.2) !important; border-color: #16a34a !important; color: #4ade80 !important; }
        
        .sbs-cell.incorrect { background-color: #fee2e2 !important; border-color: #ef4444 !important; color: #b91c1c !important; font-weight: 800; }
        html.dark .sbs-cell.incorrect { background-color: rgba(239, 68, 68, 0.2) !important; border-color: #ef4444 !important; color: #f87171 !important; }

        .sbs-cell.wrong { 
            opacity: 1; 
            font-weight: 800; 
        }
        /* --- NEW SLIDER STYLES --- */
.slider-adj-btn {
    width: 28px; height: 28px;
    border-radius: 8px;
    background-color: #f3f4f6;
    color: #4b5563;
    font-weight: 800;
    display: flex; align-items: center; justify-content: center;
    transition: background-color 0.2s;
    user-select: none;
}
.slider-adj-btn:active { background-color: #d1d5db; transform: scale(0.95); }
html.dark .slider-adj-btn { background-color: #374151; color: #e5e7eb; }
html.dark .slider-adj-btn:active { background-color: #4b5563; }

#slider-touch-area { touch-action: none; }

/* --- Animation Updates --- */

/* Existing transitions for the pin */
#slider-answer-pin {
    transition-property: left, background-color;
    transition-timing-function: ease-out; 
}

/* Text Pop Effect (for Feedback) */
@keyframes text-pop {
    0% { opacity: 0; transform: scale(0.5); }
    50% { opacity: 1; transform: scale(1.3); }
    100% { opacity: 1; transform: scale(1); }
}
.animate-text-pop { 
    animation: text-pop 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; 
}

/* Standard Score Pop (Single) */
@keyframes score-pop-single { 
    0% { transform: scale(1); } 
    50% { transform: scale(1.5); color: var(--color-primary); } 
    100% { transform: scale(1); } 
}
.animate-score-pop { animation: score-pop-single 0.4s ease-out; }

/* Level Up Score Pop (Triple Pulse) */
@keyframes score-pop-multi { 
    0% { transform: scale(1); } 
    25% { transform: scale(1.4); } 
    50% { transform: scale(1); } 
    75% { transform: scale(1.4); } 
    100% { transform: scale(1); } 
}
.animate-score-levelup { animation: score-pop-multi 1.2s ease-in-out; }

.stripe-pattern {
    background-image: repeating-linear-gradient(45deg, transparent, transparent 4px, rgba(0,0,0,0.1) 4px, rgba(0,0,0,0.1) 8px);
}

/* Smaller Thumbs */
#thumb-min, #thumb-max {
    width: 1.5rem !important; 
    height: 1.5rem !important; 
    top: 1.5rem !important; 
}

.thumb-active { transform: translate(-50%, -50%) scale(1.15) !important; cursor: grabbing !important; }

/* Ticks Position - Moved UP closer to line (was 3.5rem) */
#slider-ticks { top: 2.75rem !important; }

/* Rounded Corners */
#slider-fill-bar, #slider-bullseye-zone {
    border-radius: 999px;
}

/* Result Popup Animation */
@keyframes float-up { 
    from { opacity: 0; transform: translate(-50%, 8px); } 
    to { opacity: 1; transform: translate(-50%, -4px); } 
}
.animate-float-result { animation: float-up 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }

/* Hide the old number line elements if they still exist */
#number-line-container { display: none !important; }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-950 text-gray-900 dark:text-gray-100 transition-colors duration-300 h-[100dvh] flex flex-col overflow-hidden">

    <header class="flex-none flex justify-between items-center px-5 py-3 z-50 w-full max-w-md mx-auto bg-gray-100/90 dark:bg-gray-950/90 backdrop-blur-sm">
        <div class="flex items-center gap-1">
            <!-- Home Icon (Moved to Far Left) -->
            <button id="home-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-800 transition text-gray-600 dark:text-gray-400 hidden" aria-label="Home">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
            </button>

            <!-- Rules Button -->
            <button id="rules-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-800 transition text-gray-600 dark:text-gray-400" aria-label="Rules">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
            </button>
            
            <!-- Leaderboard Icon -->
            <button id="leaderboard-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-800 transition text-gray-600 dark:text-gray-400" aria-label="Leaderboard">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 20V10"/><path d="M12 20V4"/><path d="M6 20v-6"/></svg>
            </button>
        </div>

        <div class="flex items-center gap-2 relative">
             <button id="reroll-btn" class="p-2 rounded-full transition hidden disabled:cursor-not-allowed disabled:opacity-60 text-emerald-600 bg-emerald-100 hover:bg-emerald-200 dark:bg-emerald-900/30 dark:text-emerald-400" aria-label="Skip Question">
                <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M16 8h.01"/><path d="M8 8h.01"/><path d="M8 16h.01"/><path d="M16 16h.01"/><path d="M12 12h.01"/></svg>
            </button>

            <button id="settings-btn" class="p-2 rounded-full hover:bg-gray-200 dark:hover:bg-gray-800 transition text-gray-600 dark:text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
            </button>

            <div id="settings-popover" class="hidden absolute top-full right-0 mt-2 w-48 bg-white dark:bg-gray-900 rounded-xl shadow-xl border border-gray-200 dark:border-gray-800 z-50 animate-enter p-2">
                <!-- Theme Toggle -->
                <div class="flex items-center justify-between p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg cursor-pointer" id="theme-toggle-row">
                    <span class="text-sm font-semibold">Theme</span>
                    <div class="flex items-center">
                        <svg id="icon-sun" class="w-5 h-5 text-orange-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                        <svg id="icon-moon" class="hidden w-5 h-5 text-blue-500" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                    </div>
                </div>
                
                <!-- Format Toggle -->
                <div class="flex items-center justify-between p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg cursor-pointer mt-1" id="format-toggle-row">
                    <span class="text-sm font-semibold">Number Format</span>
                    <div id="format-indicator" class="text-xs font-bold px-2 py-1 bg-gray-200 dark:bg-gray-700 rounded">123</div>
                </div>

                <!-- Animation Toggle -->
                <div class="flex items-center justify-between p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg cursor-pointer mt-1" id="anim-toggle-row">
                    <span class="text-sm font-semibold">Animations</span>
                    <div id="anim-indicator" class="text-xs font-bold px-2 py-1 bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded">ON</div>
                </div>
                <!-- Dead Zone Toggle -->
<div class="flex items-center justify-between p-2 hover:bg-gray-100 dark:hover:bg-gray-800 rounded-lg cursor-pointer mt-1" id="dead-zone-toggle-row">
    <span class="text-sm font-semibold">Dead Zone</span>
    <div id="dead-zone-indicator" class="text-xs font-bold px-2 py-1 bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 rounded">ON</div>
</div>
            </div>
        </div>
    </header>

    <main class="flex-1 w-full max-w-md mx-auto px-5 overflow-y-auto no-scrollbar relative">
<canvas id="share-canvas" style="display: none;"></canvas>
        
        <div id="custom-alert" class="fixed top-4 left-1/2 transform -translate-x-1/2 bg-blue-600 text-white border border-blue-700 px-4 py-2 rounded-full shadow-xl z-[80] font-bold text-sm opacity-0 pointer-events-none transition-all duration-300 whitespace-nowrap flex items-center gap-2"></div>

        <div id="loading-screen" class="absolute inset-0 flex items-center justify-center bg-gray-100 dark:bg-gray-950 z-40 hidden" style="display:none;">
            <div class="text-center">
                <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600 mx-auto mb-4"></div>
                <p class="text-sm text-gray-500">Loading stats...</p>
            </div>
        </div>

        <div id="start-screen" class="flex flex-col gap-6 w-full pt-4">
            <div class="text-center space-y-1 mb-2 mt-4">
    <h2 class="text-4xl font-black text-gray-900 dark:text-white tracking-tighter">MLB<span class="text-blue-600">Matchups</span></h2>
    <p class="text-sm font-medium text-gray-500 dark:text-gray-400">The Ultimate Stat Estimation Game</p>
</div>
            <div class="bg-white dark:bg-gray-900 p-5 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 space-y-6">
                <div>
                        <label class="block text-xs font-bold uppercase text-gray-400 mb-2 tracking-wider">Game Mode</label>
<div class="flex bg-gray-100 dark:bg-gray-800 p-1 rounded-xl gap-1">
    <button class="flex-1 py-2 text-xs sm:text-sm font-semibold rounded-lg bg-white dark:bg-gray-700 text-blue-600 dark:text-white shadow-sm transition-all gamemode-btn" data-mode="howMuch">How Much?</button>
    <button class="flex-1 py-2 text-xs sm:text-sm font-medium rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 transition-all gamemode-btn" data-mode="sideBySide">Showdown</button>
    <button class="flex-1 py-2 text-xs sm:text-sm font-medium rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 transition-all gamemode-btn" data-mode="pickEm">Pick 'Em</button>
</div>
                </div>
                <div>
                    <label class="block text-xs font-bold uppercase text-gray-400 mb-2 tracking-wider">Player Pool</label>
                    <div class="flex bg-gray-100 dark:bg-gray-800 p-1 rounded-xl gap-1">
                        <button class="flex-1 py-2 text-xs sm:text-sm font-semibold rounded-lg bg-white dark:bg-gray-700 text-blue-600 dark:text-white shadow-sm transition-all mode-btn" data-mode="all">All</button>
                        <button class="flex-1 py-2 text-xs sm:text-sm font-medium rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 transition-all mode-btn" data-mode="allStars">All Stars</button>
                        <button class="flex-1 py-2 text-xs sm:text-sm font-medium rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 transition-all mode-btn" data-mode="batters">Batters</button>
                        <button class="flex-1 py-2 text-xs sm:text-sm font-medium rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 transition-all mode-btn" data-mode="pitchers">Pitchers</button>
                    </div>
                </div>
               <div class="relative w-fit">
    <label class="block text-xs font-bold uppercase text-gray-400 mb-2 tracking-wider">Era</label>
    <button id="era-trigger-btn" class="w-auto min-w-[100px] flex justify-center items-center bg-white dark:bg-gray-700 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-600 text-left px-3 py-2 rounded-xl transition-colors">
        <span id="era-display-text" class="text-xs sm:text-sm font-semibold text-blue-600 dark:text-white">Modern</span>
        <svg class="w-4 h-4 text-gray-500 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
    </button>
    
    <div id="era-popover" class="hidden absolute top-0 left-full ml-2 w-56 z-50 grid grid-cols-3 gap-1 bg-white dark:bg-gray-900 p-2 rounded-xl border border-gray-200 dark:border-gray-800 shadow-xl animate-enter">

<button class="era-option col-span-1 py-2 rounded-lg text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-800 text-xs sm:text-sm font-medium transition border border-transparent" data-era="allEras">All Eras</button>

<button class="era-option col-span-2 py-2 rounded-lg bg-white dark:bg-gray-700 text-blue-600 dark:text-white font-semibold text-xs sm:text-sm border border-transparent shadow-sm" data-era="modern">Modern Era (1970+)</button>
        
        </div>
</div>
            </div>
            <button id="start-game-btn" class="primary-btn mt-2">Start Game</button>
            <div class="h-8"></div>
        </div>

        <div id="game-screen" class="hidden flex-col h-full w-full pb-8">
            <!-- Game Header Info -->
            <div class="flex justify-between items-start mb-2 px-1">
                <!-- Left Side: Increased top margin (mt-1), removed gap (gap-0) to tighten text -->
                <div class="flex flex-col gap-0 mt-0.5">
                     <!-- Era Label -->
                     <div class="h-4 flex items-center text-xs font-bold text-gray-400" id="game-era-label">Era</div>
                     <!-- Pool Label -->
                     <div id="game-cat-label" class="text-xs font-bold text-gray-400 leading-none">Category</div>
                </div>
                
                <!-- Right Side: Kept gap-1 for spacing between Round and Score -->
                <div class="text-right flex flex-col gap-1">
                    <!-- Round Label -->
                    <div class="h-4 flex items-center justify-end text-xs font-bold text-gray-400" id="round-display">Round 1/10</div>
                    <!-- Score -->
                    <div class="text-lg font-black leading-none transition-colors duration-300" id="score-display">0</div>
                </div>
            </div>

            <div id="ui-how-much" class="w-full">
                <!-- Removed 'uppercase' class -->
                <div id="player-prompt" class="text-center text-sm font-bold text-gray-500 dark:text-gray-400 tracking-wide mb-3 mt-4">Whose is Higher?</div>

                <div class="grid grid-cols-2 gap-3 mb-6">
                    <button id="card-A" class="player-card group relative flex flex-col items-center justify-center p-2 h-16 bg-white dark:bg-gray-900 rounded-2xl border-2 border-transparent shadow-sm transition-all duration-200 active:scale-[0.98]">
                        <div id="name-A-container" class="w-full text-center z-10">
                            <span id="name-A" class="text-sm sm:text-base font-black leading-tight text-center group-hover:scale-105 transition-transform block">Player A</span>
                        </div>
                        <div class="stat-reveal mt-1 text-xs font-semibold hidden text-gray-600 dark:text-gray-300" id="stat-A">--</div>
                    </button>
                    <button id="card-B" class="player-card group relative flex flex-col items-center justify-center p-2 h-16 bg-white dark:bg-gray-900 rounded-2xl border-2 border-transparent shadow-sm transition-all duration-200 active:scale-[0.98]">
                        <div id="name-B-container" class="w-full text-center z-10">
                            <span id="name-B" class="text-sm sm:text-base font-black leading-tight text-center group-hover:scale-105 transition-transform block">Player B</span>
                        </div>
                        <div class="stat-reveal mt-1 text-xs font-semibold hidden text-gray-600 dark:text-gray-300" id="stat-B">--</div>
                    </button>
                </div>

                <!-- "By How Much?" Label -->
                <div class="text-center text-sm font-bold text-gray-500 dark:text-gray-400 mb-2">By How Much?</div>


<input type="hidden" id="min-input" value="0">
<input type="hidden" id="max-input" value="0">
<!-- SLIDER CONTAINER -->
<div class="bg-white dark:bg-gray-900 px-2 pt-4 pb-8 rounded-2xl shadow-sm border border-gray-200 dark:border-gray-800 mb-4 select-none">
    
    <!-- Controls / Header -->
    <div class="flex justify-center items-end mb-2 gap-4 sm:gap-8">
        <!-- Min Control -->
        <div class="flex flex-col items-center gap-1">
            <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">MIN DIFF</span>
            <div class="flex items-center gap-2 bg-gray-50 dark:bg-gray-800 rounded-xl p-1 shadow-sm border border-gray-200 dark:border-gray-700">
                <button class="slider-adj-btn" onclick="adjustSlider('min', -1)">-</button>
                <span id="slider-display-min" class="font-black text-xl w-14 text-center tabular-nums text-blue-600 dark:text-blue-400">0</span>
                <button class="slider-adj-btn" onclick="adjustSlider('min', 1)">+</button>
            </div>
        </div>

        <!-- Max Control -->
        <div class="flex flex-col items-center gap-1">
            <span class="text-[10px] font-bold text-gray-400 uppercase tracking-wider">MAX DIFF</span>
            <div class="flex items-center gap-2 bg-gray-50 dark:bg-gray-800 rounded-xl p-1 shadow-sm border border-gray-200 dark:border-gray-700">
                <button class="slider-adj-btn" onclick="adjustSlider('max', -1)">-</button>
                <span id="slider-display-max" class="font-black text-xl w-14 text-center tabular-nums text-blue-600 dark:text-blue-400">0</span>
                <button class="slider-adj-btn" onclick="adjustSlider('max', 1)">+</button>
            </div>
        </div>
    </div>

    <!-- Slider Track Area - Increased top margin (mt-8) to push it down -->
    <div class="relative h-12 mx-3 mt-8" id="slider-touch-area">
        
        <!-- The Track -->
        <div class="absolute top-4 left-0 right-0 h-4 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden">
            <!-- Invalid Zone -->
            <div id="slider-invalid-zone" class="absolute left-0 top-0 h-full bg-gray-300 dark:bg-gray-600 opacity-50 stripe-pattern w-0 border-r border-gray-400/30"></div>
            
            <!-- User Selection Bar -->
            <div id="slider-fill-bar" class="absolute top-0 h-full bg-blue-500 opacity-90 transition-all duration-75"></div>

            <!-- Bullseye Target -->
            <div id="slider-bullseye-zone" class="absolute top-0 h-full bg-amber-400 opacity-90 hidden"></div>
        </div>

        <!-- Correct Answer Pin -->
        <div id="slider-answer-pin" class="absolute top-[6px] w-1.5 h-7 bg-green-500 rounded-full shadow-[0_0_8px_rgba(34,197,94,0.8)] hidden z-30 pointer-events-none transform -translate-x-1/2 transition-all duration-500 border border-white dark:border-gray-900">
            <!-- Result Text Popup -->
            <div id="result-diff-display" class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-0 text-sm font-black whitespace-nowrap bg-white dark:bg-gray-800 px-2 py-1 rounded-lg shadow-md border border-gray-100 dark:border-gray-700 opacity-0 text-gray-900 dark:text-white"></div>
        </div>

        <!-- Ticks Row -->
        <div id="slider-ticks" class="absolute top-12 w-full flex justify-between px-0"></div>

        <!-- Draggable Thumbs -->
        <div id="thumb-min" class="absolute top-6 w-6 h-6 bg-white dark:bg-gray-100 rounded-full shadow-[0_2px_5px_rgba(0,0,0,0.2)] border-2 border-blue-600 z-20 cursor-grab active:cursor-grabbing transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center touch-manipulation transition-transform duration-75 hover:scale-105">
            <div class="w-1 h-3 bg-gray-300 rounded-full pointer-events-none"></div>
        </div>
        
        <div id="thumb-max" class="absolute top-6 w-6 h-6 bg-white dark:bg-gray-100 rounded-full shadow-[0_2px_5px_rgba(0,0,0,0.2)] border-2 border-blue-600 z-20 cursor-grab active:cursor-grabbing transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center touch-manipulation transition-transform duration-75 hover:scale-105">
            <div class="w-1 h-3 bg-gray-300 rounded-full pointer-events-none"></div>
        </div>

    </div>
</div>
               
            </div>

            <div id="ui-side-by-side" class="w-full hidden">
                <div class="grid grid-cols-3 gap-1 mb-2 mt-4 text-center items-end">
                    <div></div> <div class="text-sm font-black leading-tight" id="sbs-name-A">Player A</div>
                    <div class="text-sm font-black leading-tight" id="sbs-name-B">Player B</div>
                </div>
                <div id="sbs-container" class="flex flex-col gap-1 mb-4">
                    </div>
            </div>
<div id="ui-pick-em" class="w-full hidden">
    <div id="pickem-prompt-container" class="text-center text-sm font-bold text-gray-500 dark:text-gray-400 tracking-wide mb-3 mt-4">
        </div>

    <div id="pickem-grid" class="grid grid-cols-2 gap-2 mb-4">
        </div>
</div>

            <div class="mt-2">
                <button id="submit-btn" disabled class="primary-btn">Lock In</button>
                <button id="next-btn" disabled class="primary-btn mt-2 hidden">Next Round</button>
            </div>
            
            <div id="round-feedback" class="mt-4 flex flex-col items-center space-y-1 min-h-[2rem]"></div>
        </div>

        <div id="game-over-screen" class="hidden flex-col items-center justify-center h-full text-center animate-enter pb-12">
            <div id="ribbon-emoji" class="text-8xl mb-4">üèÜ</div>
            <h2 class="text-4xl font-black text-gray-900 dark:text-white mb-2">Game Over!</h2>
            <p id="ribbon-text" class="text-lg text-gray-500 mb-8">Great effort!</p>
            <div class="bg-white dark:bg-gray-900 px-10 py-6 rounded-3xl shadow-sm border border-gray-200 dark:border-gray-800 mb-8 w-full max-w-xs">
                <div class="text-xs font-bold text-gray-400 uppercase tracking-widest mb-2">Final Score</div>
                <div class="text-6xl font-black text-blue-600 dark:text-blue-400" id="final-score">0</div>
            </div>
            
            <div id="highscore-input-container" class="hidden w-full max-w-xs mb-4">
                <div class="text-green-600 dark:text-green-400 font-bold text-sm mb-2 animate-pulse">NEW HIGH SCORE!</div>
                <input type="text" id="player-name-input" placeholder="Enter your name" maxlength="10" class="w-full text-center bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl px-4 py-3 font-bold text-lg focus:outline-none focus:border-blue-500 dark:text-white mb-2">
                <button id="save-score-btn" class="primary-btn bg-green-600 hover:bg-green-700 mb-2">Save to Leaderboard</button>
            </div>
            <div class="flex gap-2 w-full max-w-xs">
                <button id="share-btn" class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg transition-transform active:scale-95 flex items-center justify-center gap-2">
                    <span>Share</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="18" cy="5" r="3"></circle><circle cx="6" cy="12" r="3"></circle><circle cx="18" cy="19" r="3"></circle><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"></line><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"></line></svg>
                </button>
                <button id="play-again-btn" class="flex-[2] primary-btn w-auto">Play Again</button>
            </div>
        </div>
    </main>

    <div id="rules-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" id="rules-overlay"></div>
        <div class="relative bg-white dark:bg-gray-900 w-full max-w-lg max-h-[80vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col animate-enter border border-gray-200 dark:border-gray-800">
            <div class="flex justify-between items-center p-5 border-b border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-900">
                <h3 class="text-lg font-black uppercase tracking-wide text-gray-800 dark:text-white">Rules &amp; Scoring</h3>
                <button id="close-rules-btn" class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition text-gray-500">&times;</button>
            </div>
            <div class="p-0 overflow-y-auto text-sm text-gray-600 dark:text-gray-300 leading-relaxed">
                
                <!-- SECTION 1: HOW TO PLAY -->
                <details open class="group border-b border-gray-100 dark:border-gray-800">
                    <summary class="flex justify-between items-center p-4 font-bold text-gray-900 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-800/50 transition select-none">
                        <span>How to Play</span>
                        <svg class="w-4 h-4 transition-transform duration-200 text-gray-400 group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </summary>
                    <div class="px-4 pb-4 pt-0 text-gray-500 dark:text-gray-400 space-y-4">
                        <div>
                            <h4 class="font-black text-blue-600 dark:text-blue-400 uppercase text-xs tracking-widest mb-2">Mode A: How Much? (Standard)</h4>
                            <ol class="list-decimal ml-5 space-y-2">
                                <li><strong>Analyze the Matchup:</strong> Review the Category (e.g., Career HR) and the two players displayed. Note if the prompt asks for the <em>Higher</em> or <em>Lower</em> stat.</li>
                                <li><strong>Pick the Winner:</strong> Tap the card of the player you believe is the statistical leader in that category.</li>
                                <li><strong>Estimate the Gap:</strong> Use the dual-slider controls to set a "Min" and "Max" range for the difference between the two players.
                                    <ul class="list-disc ml-4 mt-1 text-xs opacity-90">
                                        <li><em>Example:</em> If Player A has 500 HR and Player B has 400 HR, the difference is 100. You might set your range from 80 to 120.</li>
                                        <li>The tighter your range, the more points you score‚Äîbut you risk missing the answer entirely.</li>
                                    </ul>
                                </li>
                                <li><strong>Lock In:</strong> Submit your guess to reveal the answer and score points.</li>
                            </ol>
                        </div>
                        <hr class="border-gray-100 dark:border-gray-800">
                        <div>
                            <h4 class="font-black text-blue-600 dark:text-blue-400 uppercase text-xs tracking-widest mb-2">Mode B: Showdown</h4>
                            <ol class="list-decimal ml-5 space-y-2">
                                <li><strong>The Face-Off:</strong> You are presented with two players and a list of 10 different statistical categories.</li>
                                <li><strong>Pick 10 Winners:</strong> For each row, tap the name of the player you think has the better stat in that specific category.</li>
                                <li><strong>Lock In:</strong> You must make a selection for all 10 categories before you can submit.</li>
                                <li><strong>The Reveal:</strong> The game will reveal the actual stats row-by-row. You need at least 5 correct to score points, and 10/10 for a massive bonus.</li>
                            </ol>
                        </div>
                    </div>
                </details>

                <!-- SECTION 2: SCORING BREAKDOWN -->
                <details class="group border-b border-gray-100 dark:border-gray-800">
                    <summary class="flex justify-between items-center p-4 font-bold text-gray-900 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-800/50 transition select-none">
                        <span>Scoring Breakdown</span>
                        <svg class="w-4 h-4 transition-transform duration-200 text-gray-400 group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </summary>
                    <div class="px-4 pb-4 pt-0 text-gray-500 dark:text-gray-400 space-y-4">
                        <div>
                            <h4 class="font-black text-green-600 dark:text-green-400 uppercase text-xs tracking-widest mb-2">Standard Mode (Max 1,000 pts/round)</h4>
                            <ul class="space-y-2">
                                <li class="flex justify-between text-sm">
                                    <span><strong>1. Correct Player</strong></span>
                                    <span class="font-bold text-green-600 dark:text-green-400">+200 Pts</span>
                                </li>
                                <li class="text-xs mb-2">You earn these points simply for identifying the correct winner. If you pick the wrong player, you score 0 for the round.</li>
                                
                                <li class="flex justify-between text-sm">
                                    <span><strong>2. Range Accuracy</strong></span>
                                    <span class="font-bold text-green-600 dark:text-green-400">0 to +800 Pts</span>
                                </li>
                                <li class="text-xs mb-2">Awarded only if the true difference falls strictly between your Min and Max sliders. The score is calculated exponentially based on how narrow your range is compared to the "Safe Zone" (the default wide range). A very tight, correct range yields max points.</li>
                                
                                <li class="flex justify-between text-sm">
                                    <span><strong>3. Bullseye Bonus</strong></span>
                                    <span class="font-bold text-amber-500">+100 Pts</span>
                                </li>
                                <li class="text-xs">A bonus awarded if the true difference lands in the exact center (middle 40%) of your predicted range.</li>
                            </ul>
                        </div>
                        <hr class="border-gray-100 dark:border-gray-800">
                        <div>
                            <h4 class="font-black text-green-600 dark:text-green-400 uppercase text-xs tracking-widest mb-2">Showdown Mode (Max 1,000 pts/round)</h4>
                            <p class="text-xs mb-2">Points are awarded based on the total number of correct selections (out of 10):</p>
                            <div class="grid grid-cols-2 gap-2 text-xs font-medium">
                                <div class="flex justify-between bg-gray-50 dark:bg-gray-800 p-2 rounded"><span>10/10 Correct</span> <span class="text-blue-600 font-bold">1,000 Pts</span></div>
                                <div class="flex justify-between bg-gray-50 dark:bg-gray-800 p-2 rounded"><span>9/10 Correct</span> <span class="text-green-600 font-bold">700 Pts</span></div>
                                <div class="flex justify-between bg-gray-50 dark:bg-gray-800 p-2 rounded"><span>8/10 Correct</span> <span class="text-green-600 font-bold">450 Pts</span></div>
                                <div class="flex justify-between bg-gray-50 dark:bg-gray-800 p-2 rounded"><span>7/10 Correct</span> <span class="text-orange-500 font-bold">250 Pts</span></div>
                                <div class="flex justify-between bg-gray-50 dark:bg-gray-800 p-2 rounded"><span>6/10 Correct</span> <span class="text-orange-500 font-bold">100 Pts</span></div>
                                <div class="flex justify-between bg-gray-50 dark:bg-gray-800 p-2 rounded"><span>0-5 Correct</span> <span class="text-gray-400 font-bold">0 Pts</span></div>
                            </div>
                        </div>
                    </div>
                </details>

                <!-- SECTION 3: ELIGIBILITY CRITERIA -->
                <details class="group border-b border-gray-100 dark:border-gray-800">
                    <summary class="flex justify-between items-center p-4 font-bold text-gray-900 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-800/50 transition select-none">
                        <span>Eligibility Criteria</span>
                        <svg class="w-4 h-4 transition-transform duration-200 text-gray-400 group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </summary>
                    <div class="px-4 pb-4 pt-0 text-gray-500 dark:text-gray-400 text-xs space-y-4">
                        <p>Players are filtered based on the <strong>Player Pool</strong> selected on the home screen.</p>
                        
                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-1">1. Standard / Batters / Pitchers Pools</h4>
                            <p class="mb-1">Designed to include recognizable players with significant careers.</p>
                            <ul class="list-disc ml-4 mb-2 space-y-1">
                                <li><strong>Hitters:</strong> Must have 5,000+ Career Plate Appearances.</li>
                                <li><strong>Pitchers:</strong> Must have 150+ Starts OR 500+ Games Played.</li>
                            </ul>
                            <p class="mb-1 italic">Additional Category-Specific Gates:</p>
                            <ul class="list-disc ml-4 space-y-1 opacity-90">
                                <li>Career Wins: ‚â• 75</li>
                                <li>Season SB: ‚â• 25 (Career ‚â• 50)</li>
                                <li>Career WAR: ‚â• 10.0</li>
                                <li>ERA/Rate Stats: Minimum IP/PA requirements apply for rate stat qualification.</li>
                            </ul>
                        </div>

                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-1">2. All-Star Pool</h4>
                            <p class="mb-1">A more exclusive list of the game's greatest players.</p>
                            <ul class="list-disc ml-4 space-y-1">
                                <li><strong>Global Gate:</strong> Player must have ‚â• 25.0 Career WAR (Wins Above Replacement).</li>
                                <li>This allows for younger stars on a Hall of Fame track (e.g., Juan Soto) who might not yet meet the 5,000 PA longevity requirement of the Standard pool.</li>
                            </ul>
                        </div>

                        <div>
                            <h4 class="font-bold text-gray-900 dark:text-white mb-1">3. Era Selection</h4>
                            <ul class="list-disc ml-4 space-y-1">
                                <li><strong>Modern Era:</strong> Players who played a significant portion of their career from 1970 to present.</li>
                                <li><strong>All Eras:</strong> Includes historical players dating back to 1871 (e.g., Ty Cobb, Cy Young).</li>
                                <li><strong>Specific Decade:</strong> Players active during the selected decade (e.g., 1990s).</li>
                            </ul>
                        </div>
                    </div>
                </details>

                <!-- SECTION 4: SPECIAL FEATURES -->
                <details class="group border-b border-gray-100 dark:border-gray-800">
                    <summary class="flex justify-between items-center p-4 font-bold text-gray-900 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-800/50 transition select-none">
                        <span>Special Features</span>
                        <svg class="w-4 h-4 transition-transform duration-200 text-gray-400 group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </summary>
                    <div class="px-4 pb-4 pt-0 text-gray-500 dark:text-gray-400 text-xs space-y-3">
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-emerald-600"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M16 8h.01"/><path d="M8 8h.01"/><path d="M8 16h.01"/><path d="M16 16h.01"/><path d="M12 12h.01"/></svg>
                                <strong class="text-gray-900 dark:text-white">The Reroll Die</strong>
                            </div>
                            <p>Stumped by a matchup? Tap the die icon in the header to skip the current question and get a new one. You get <strong>one reroll per game</strong>. Using it does not penalize your score, but it cannot be undone.</p>
                        </div>

                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <span class="bg-gray-200 text-gray-600 px-1 rounded text-[9px] font-bold">123</span>
                                <strong class="text-gray-900 dark:text-white">Number Format Toggle</strong>
                            </div>
                            <p>In the settings menu (top right), you can toggle between "123" (Whole Numbers) and ".12" (Decimals). This affects how stats like Batting Average are displayed (e.g., "300" vs "0.300").</p>
                        </div>

                        <div>
                            <strong class="text-gray-900 dark:text-white block mb-1">Challenge & Share</strong>
                            <p>At the end of a game, click "Share" to generate a unique Challenge Link. Send this to a friend, and they will play the <strong>exact same 10 matchups</strong> you just played. See who knows their history better!</p>
                        </div>

                        <div>
                            <strong class="text-gray-900 dark:text-white block mb-1">Baseball Reference Links</strong>
                            <p>After a round is locked in, player names become clickable links. Tap any player's name to visit their official Baseball-Reference page and verify their stats.</p>
                        </div>
                    </div>
                </details>
            </div>
        </div>
    </div>

    <div id="leaderboard-modal" class="hidden fixed inset-0 z-[100] flex items-center justify-center px-4">
        <div class="absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity" id="leaderboard-overlay"></div>
        <div class="relative bg-white dark:bg-gray-900 w-full max-w-md max-h-[80vh] rounded-3xl shadow-2xl overflow-hidden flex flex-col animate-enter border border-gray-200 dark:border-gray-800">
            
            <div class="p-4 border-b border-gray-100 dark:border-gray-800 bg-gray-50 dark:bg-gray-900 space-y-3">
                <div class="flex justify-between items-center">
                     <h3 class="text-sm font-black uppercase tracking-wide text-gray-500 dark:text-gray-400">Leaderboard</h3>
                     <button id="close-leaderboard-btn" class="p-1 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition text-gray-500">&times;</button>
                </div>
                
                <div class="grid grid-cols-3 gap-2">
                    <select id="lb-filter-mode" class="w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 text-xs font-bold rounded-lg px-2 py-2 focus:outline-none focus:border-blue-500">
                        <option value="all">All Modes</option>
                        <option value="howMuch">How Much?</option>
                        <option value="sideBySide">Showdown</option>
                    </select>

                    <select id="lb-filter-pool" class="w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 text-xs font-bold rounded-lg px-2 py-2 focus:outline-none focus:border-blue-500">
                        <option value="all_pools">All Pools</option>
                        <option value="all">Standard</option>
                        <option value="allStars">All Stars</option>
                        <option value="batters">Batters</option>
                        <option value="pitchers">Pitchers</option>
                    </select>

                    <select id="lb-filter-date" class="w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 text-gray-700 dark:text-gray-200 text-xs font-bold rounded-lg px-2 py-2 focus:outline-none focus:border-blue-500">
                        <option value="today">Today</option>
                        <option value="all_time">All Time</option>
                        </select>
                </div>
            </div>

            <div class="p-0 overflow-y-auto">
                <table class="w-full text-sm text-left">
                    <thead class="text-xs text-gray-400 uppercase bg-gray-50 dark:bg-gray-800/50 sticky top-0">
                        <tr>
                            <th class="px-4 py-3 text-center w-12 font-bold">#</th>
                            <th class="px-4 py-3 text-left w-24 font-bold">Score</th>
                            <th class="px-4 py-3 text-left font-bold">Player</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboard-body" class="text-gray-700 dark:text-gray-300 font-medium"></tbody>
                </table>
                <div id="empty-leaderboard-msg" class="hidden p-8 text-center text-gray-400 text-sm">
                    No scores found for this filter.
                </div>
            </div>
        </div>
    </div>

    <script>
    /* Diagnostic: fetch game.js, parse it with new Function() to get exact error */
    window.addEventListener('DOMContentLoaded', function() {
        var btn = document.getElementById('start-game-btn');
        fetch('game.js').then(function(r) { return r.text(); }).then(function(code) {
            try {
                new Function(code);
                btn.textContent = 'PARSE OK (len=' + code.length + ') - executing...';
                var s = document.createElement('script');
                s.textContent = code;
                document.head.appendChild(s);
                setTimeout(function() {
                    if (typeof btn.onclick === 'function') {
                        btn.textContent = 'Start Game';
                        btn.style.background = '';
                    } else {
                        btn.textContent = 'Parsed OK but init failed - check console';
                        btn.style.background = '#f97316';
                    }
                }, 2000);
            } catch(e) {
                btn.textContent = 'PARSE ERROR: ' + e.message;
                btn.style.background = '#ef4444';
                btn.style.fontSize = '11px';
                btn.style.wordBreak = 'break-all';
                btn.style.whiteSpace = 'normal';
                btn.style.height = 'auto';
                btn.style.padding = '8px';
            }
        }).catch(function(e) {
            btn.textContent = 'FETCH ERROR: ' + e.message;
            btn.style.background = '#ef4444';
        });
    });
    </script>
</body>
</html>
